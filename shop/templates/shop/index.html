{% extends 'shop/base.html' %}

{% load static %}

{% block ff %}
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

<style>
  /* Style général pour la page des produits */
.product-card {
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;

}

.product-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.product-img {
  max-height: 200px;
  object-fit: cover;
  width: 100%;
}

.product-name {
  font-size: 1.2rem;
  font-weight: 600;
}

.product-price {
  font-size: 1.1rem;
}

.rating .star {
  font-size: 1.2rem;
  cursor: pointer;
  color: #ddd;
  transition: color 0.3s;
}

.rating .star.filled {
  color: #ffc107;
}

.comment-field {
  width: 100%;
  border: 1px solid #ddd;
  border-radius: 5px;
  padding: 8px;
  resize: none;
}

.view-details, .add-to-cart {
  font-size: 0.5rem;
  padding: 8px 20px;
}
h4, h3 {
     font-size: 15px;
 }
/* Réagir à la navbar fixe */
body {
  font-style: italic;
  padding-top: 100px; /* Ajustez cette valeur en fonction de la hauteur de votre navbar */
}

/* Adaptation de l'affichage des boutons au survol */
.view-details {
  display: none;
  margin-top: 10px;
  padding: 8px 20px;
  background-color: #007BFF;
  border: none;
  color: white;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1rem;
}
.add-to-cart {
  display: none;
  margin-top: 10px;
  padding: 8px 20px;
  background-color: #007BFF;
  border: none;
  color: white;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1rem;
}

.product-card:hover .view-details,
.product-card:hover .add-to-cart {
  display: inline-block;

}

.add-to-cart {
  background-color: #28a745;
}

.add-to-cart:hover {
  background-color: #218838;
}

.view-details:hover {
  background-color: #0056b3;
}

/* Ajustement des étoiles */
.star {
  font-size: 2rem;
  cursor: pointer;
  color: #ddd; /* Couleur des étoiles vides */
  transition: color 0.3s;
}

.star.filled {
  color: #ffc107; /* Couleur des étoiles remplies */
}


/* Media Queries pour différents écrans */
@media (max-width: 768px) {
  .view-details,
  .add-to-cart {
    font-size: 0.7rem; /* Réduction de la taille sur les tablettes */
    padding: 4px 10px;
  }
}

@media (max-width: 576px) {
  .view-details,
  .add-to-cart {
    font-size: 0.7rem; /* Taille ajustée pour une meilleure lisibilité */
    padding: 4px 10px; /* Réduction de l'espacement pour éviter les débordements */
    margin: 5px 2px; /* Ajout d'un espacement entre les boutons */
    width: 100%; /* Chaque bouton occupe environ la moitié de la largeur */
  }

  .product-card .d-flex {
    display: flex;
    /*flex-wrap: wrap; /* Permet aux boutons de passer sur deux lignes si nécessaire
    justify-content: space-between; /* Espace égal entre les boutons */
    gap: 5px; /* Espacement supplémentaire entre les boutons */
  }
  .view-details,
  .add-to-cart {
    display: inline-block;

  }
}

/* Adaptation de la disposition sur mobile */
@media (max-width: 480px) {
  body {
    padding-top: 120px; /* Ajuster selon la hauteur de votre navbar */
  }

  .product-card {
    padding: 10px; /* Réduire le padding pour les petits écrans */
  }

  .product-img {
    max-height: 200px; /* Réduire la taille de l'image */
  }


}
/* Style général pour les cartes de catégories */
.category-card {
  display: block;
  text-align: center;
  text-decoration: none;
  color: inherit;
  margin-bottom: 20px;
}
.category-card:hover {
  transform: translateY(-10px);

}

.category-circle {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  overflow: hidden;
  margin: 0 auto;
  background-color: #fff;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.category-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.category-title {
  font-size: 1rem;
  margin-top: 10px;
  font-weight: bold;
  color: #333;
  text-transform: capitalize;
}

/* Style de survol */
.category-card:hover .category-circle {
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

/* Styles de responsive */
@media (max-width: 768px) {
  .category-title {
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .category-title {
    font-size: 0.9rem;
  }
}

    .carousel-item {
        /*display: flex;*/
        align-items: center;
        justify-content: center;
    }
    .carousel-content {
        display: flex;
        /*align-items: center;*/
        justify-content: space-between;
        width: 100%;
        /*max-width: 1200px;*/
        background: white;
        border-radius: 10px;


    }
    .carousel-text {
        width: 50%;
        padding: 20px;
        margin-top: 80px;
    }
    .carousel-text h3 {
        font-size: 24px;
        font-weight: bold;
        color: black;
    }
    .carousel-text p {
        font-size: 16px;
        color: black;
    }
    .carousel-image {
        width: 50%;
    }
    .carousel-image img {
        max-width: 100%;

    }

    @media (max-width: 768px) {
      .carousel-item {
        margin-top: 50px;
        align-items: center;

      }

      .carousel-content {
        align-items: center;

      }
      .carousel-text {
        width: 50%;
        padding: 20px;

       }
    }



</style>

<style type="text/tailwindcss">
@layer base {
:root {
--background: 0 0% 100%;
--foreground: 240 10% 3.9%;
--card: 0 0% 100%;
--card-foreground: 240 10% 3.9%;
--popover: 0 0% 100%;
--popover-foreground: 240 10% 3.9%;
--primary: 240 5.9% 10%;
--primary-foreground: 0 0% 98%;
--secondary: 240 4.8% 95.9%;
--secondary-foreground: 240 5.9% 10%;
--muted: 240 4.8% 95.9%;
--muted-foreground: 240 3.8% 46.1%;
--accent: 240 4.8% 95.9%;
--accent-foreground: 240 5.9% 10%;
--destructive: 0 84.2% 60.2%;
--destructive-foreground: 0 0% 98%;
--border: 240 5.9% 90%;
--input: 240 5.9% 90%;
--ring: 240 5.9% 10%;
--radius: 0.5rem;
				}
				.dark {
					--background: 240 10% 3.9%;
--foreground: 0 0% 98%;
--card: 240 10% 3.9%;
--card-foreground: 0 0% 98%;
--popover: 240 10% 3.9%;
--popover-foreground: 0 0% 98%;
--primary: 0 0% 98%;
--primary-foreground: 240 5.9% 10%;
--secondary: 240 3.7% 15.9%;
--secondary-foreground: 0 0% 98%;
--muted: 240 3.7% 15.9%;
--muted-foreground: 240 5% 64.9%;
--accent: 240 3.7% 15.9%;
--accent-foreground: 0 0% 98%;
--destructive: 0 62.8% 30.6%;
--destructive-foreground: 0 0% 98%;
--border: 240 3.7% 15.9%;
--input: 240 3.7% 15.9%;
--ring: 240 4.9% 83.9%;
				}
			}

 </style>

{% endblock ff %}

{% block index %}


<div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
        <div class="carousel-item active">
            <div class="carousel-content">
                <div class="carousel-text">
                    <h3>Un aliment paléolithique</h3>
                    <p>produit naturel et non transformé, consommé par nos ancêtres chasseurs-cueilleurs. Il inclut viandes maigres, poissons, fruits, légumes.</p>
                </div>
                <div class="carousel-image">
                    <img src="{% static "img/gallery/vegetari.jpg" %}" alt="Image 1">
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="carousel-content">
                <div class="carousel-text">
                    <h3>Un aliment sans gluten</h3>
                    <p>Un aliment adapté aux personnes sensibles à cette protéine présente dans le blé, l'orge et le seigle, un aliment saint.</p>
                </div>
                <div class="carousel-image">
                    <img src="{% static "img/gallery/sans_gluten.jpg" %}" alt="Image 2">
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="carousel-content">
                <div class="carousel-text">
                    <h3>Un aliment sans gluten</h3>
                    <p>Un aliment adapté aux personnes sensibles à cette protéine présente dans le blé, l'orge et le seigle, un aliment saint.</p>
                </div>
                <div class="carousel-image">
                    <img src="{% static "img/gallery/sans_gluten.jpg" %}" alt="Image 3">
                </div>
            </div>
        </div>
        <button class="carousel-control-prev"  type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
        </button>
    </div>

</div>

    <!--<section class="py-0 overflow-hidden" id="home"  style="height: 85vh;"> <!-- Changer py-5 en py-0 pour enlever les marges -->
    <!--    <div class="container-fluid h-100"> <!-- Utilisation de container-fluid pour prendre toute la largeur -->
    <!--        <div id="customCarousel" class="carousel slide" data-bs-ride="carousel" style="height: 100%;">-->
    <!--            <div class="carousel-indicators">-->
    <!--                <button type="button" data-bs-target="#customCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>-->
    <!--                <button type="button" data-bs-target="#customCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>-->
    <!--                <button type="button" data-bs-target="#customCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>-->
    <!--            </div>-->
    <!--            <div class="carousel-inner" style="height: 100%;">-->
                    <!-- Slide 1 -->
    <!--                <div class="carousel-item active">-->
    <!--                    <div class="slide-content" style="background-image: url('{% static "img/gallery/vegetari.jpg" %}');"></div>-->
    <!--                    <div class="row">-->
    <!--                        <div class="col-12 text-center">-->
    <!--                            <h1 class="display-3 text-light mb-3">Un aliment paléolithique</h1>-->
    <!--                            <p class="text-light mb-5">produit naturel et non transformé, consommé par nos ancêtres chasseurs-cueilleurs. Il inclut viandes maigres, poissons, fruits, légumes, noix et graines, excluant les produits transformés.</p>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
                    <!-- Slide 2 -->
    <!--                <div class="carousel-item">-->
    <!--                    <div class="slide-content" style="background-image: url('{% static "img/gallery/sans_gluten.jpg" %}');"></div>-->
    <!--                    <div class="row">-->
    <!--                        <div class="col-12 text-center">-->
    <!--                            <h1 class="display-3 text-light mb-3">Un aliment sans gluten</h1>-->
    <!--                            <p class="text-light mb-5">Un aliment adapté aux personnes sensibles à cette protéine présente dans le blé, l'orge et le seigle.</p>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
                    <!-- Slide 3 -->
    <!--                <div class="carousel-item">-->
    <!--                    <div class="slide-content" style="background-image: url('{% static "img/gallery/vegetarien.jpg" %}');"></div>-->
    <!--                    <div class="row">-->
    <!--                        <div class="col-12 text-center">-->
    <!--                            <h1 class="display-3 text-light mb-3">Aliment végétarien</h1>-->
    <!--                            <p class="text-light mb-5">aliment ne contenant pas de viande ni de poisson, mais peut inclure des produits d'origine animale comme les œufs, le lait et le fromage.</p>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
                <!-- Carousel controls -->
    <!--            <button class="carousel-control-prev" type="button" data-bs-target="#customCarousel" data-bs-slide="prev">-->
    <!--                <span class="carousel-control-prev-icon" aria-hidden="true"></span>-->
    <!--                <span class="visually-hidden">Previous</span>-->
    <!--            </button>-->
    <!--            <button class="carousel-control-next" type="button" data-bs-target="#customCarousel" data-bs-slide="next">-->
    <!--                <span class="carousel-control-next-icon" aria-hidden="true"></span>-->
    <!--                <span class="visually-hidden">Next</span>-->
    <!--            </button>-->
    <!--        </div>-->
    <!--    </div>-->
    <!--</section>-->






    <section class="pb-3 pt-5">

        <div class="container">
        {% if query %}
        <h2 class="mt-3">Résultats pour "{{ query }}" :</h2>
        <div class="row">
        {% for product in search_results %}
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <!-- Carte de produit -->
            <div class="product-card shadow">
                <div class="card-content">
                    <!-- Image du produit -->
                    <img id="pp{{ product.id }}" class="product-img img-fluid rounded" src="{{ product.photo.url }}" alt="{{ product.name }}">

                    <!-- Nom du produit -->
                    <h3 id="aa{{ product.id }}" class="product-name text-center mt-3">{{ product.name }}</h3>

                    <!-- Prix -->
                    <p id="price{{ product.id }}" class="product-price text-center text-success fw-bold">
                        {{ product.price|floatformat:0 }}
                    </p>

                    <!-- Évaluation -->
                    <div class="rating d-flex justify-content-center" data-product-id="{{ product.id }}">
                        {% for i in "12345" %}
                            <span
                              class="star {% if forloop.counter <= product.rating %}filled{% else %}empty{% endif %}"
                              data-value="{{ forloop.counter }}">
                              ★
                            </span>
                        {% endfor %}
                    </div>

                    <!-- Boutons d'action -->
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        {% if product.id %}
                            <a class="view-details btn btn-primary btn-sm" href="{% url 'detailPro' product.id %}" role="button">Voir +</a>
                        {% else %}
                            <span>Produit non disponible</span>
                        {% endif %}
                        <a class="add-to-cart btn btn-danger btn-sm ted" id="{{ product.id }}" role="button">Ajouter <i class="fas fa-shopping-cart"></i></a>
                    </div>
                </div>
            </div>
        </div>
        {% if forloop.counter|divisibleby:4 and not forloop.last %}
            <!-- Insérer un saut de ligne pour chaque groupe de 4 produits -->
            <div class="w-100"></div>
        {% endif %}
        {% empty %}
        <p>Aucun produit trouvé.</p>
        {% endfor %}
        </div>
        {% endif %}

        </div>
    </section>



<section id="testimonial" class="py-4 overflow-hidden no-scroll">
<div class="container">
    <div class="row h-100 mt-1">

        <script>
        const userIsAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
        </script>
        <!-- Boucle pour afficher les produits par catégorie -->
        <h4 class="fw-bold fs-3 fs-lg-5 lh-sm">Produits par catégorie</h4>
        {% for category_data in categories_with_products %}
            <div class="col-12">

                <h5 class="fw-bold fs-3 fs-lg-5 lh-sm">{{ category_data.category.nom }}</h5>
                <div class="row gx-4 gy-5">
                    {% for product in category_data.products %}
                        <div class="col-6 col-sm-6 col-md-4 col-lg-3">  <!-- Deux produits par ligne sur mobile -->
                            <!-- Carte de produit -->
                            <div class="product-card shadow">
                                <div class="card-content">
                                    <img id="pp{{ product.id }}" class="product-img img-fluid rounded" src="{{ product.photo.url }}" alt="{{ product.name }}">
                                    <h3 id="aa{{ product.id }}" class="product-name text-center mt-3">{{ product.name }}</h3>
                                    <p id="price{{ product.id }}" class="product-price text-center text-success fw-bold">
                                        {{ product.price|floatformat:0 }} fcfa
                                    </p>

                                    <div class="rating d-flex justify-content-center" data-product-id="{{ product.id }}">
                                        {% for i in "12345" %}
                                            <span
                                                class="star {% if forloop.counter <= product.rating %}filled{% else %}empty{% endif %}"
                                                data-value="{{ forloop.counter }}">
                                                ★
                                            </span>
                                        {% endfor %}
                                    </div>
                                    <div class="d-flex flex-column d-sm-none justify-content-between align-items-center mt-3">
                                        {% if product.id %}
                                            <a class="view-details btn btn-primary btn-sm mb-2" href="{% url 'detailPro' product.id %}" role="button">Voir +</a>
                                        {% else %}
                                            <span>Produit non disponible</span>
                                        {% endif %}

                                        <a class="add-to-cart btn btn-lg btn-danger btn-sm ted" id="{{ product.id }}" role="button">Ajouter</a>
                                    </div>
                                    <div class="d-flex d-none d-sm-flex justify-content-between align-items-center mt-3">
                                        {% if product.id %}
                                            <a class="view-details btn btn-lg btn-primary btn-sm" href="{% url 'detailPro' product.id %}" role="button">Voir +</a>
                                        {% else %}
                                            <span>Produit non disponible</span>
                                        {% endif %}

                                        <a class="add-to-cart btn btn-lg btn-danger btn-sm ted" id="{{ product.id }}" role="button">Ajouter</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
</section>




      <section class="py-0">
        <div class="bg-holder" style="background-image:url({% static 'img/gallery/cta-two-bg.png' %});background-position:center;background-size:cover;">
            </div>
            <!--/.bg-holder-->

            <div class="container">
              <div class="row flex-center">
                <div class="col-xxl-9 py-7 text-center">
                  <h1 class="fw-bold mb-4 text-white fs-6">Êtes-vous prêt à commander avec<br />les meilleures offres ? </h1><a class="btn btn-danger" href="{% url 'produit' %}"> VOIR LES PRODUITS<i class="fas fa-chevron-right ms-2"></i></a>
                </div>
              </div>
            </div>
          </section>


<!-- Modal Bootstrap -->
    <div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Header de la modale -->
                <div class="modal-header">
                    <h5 class="modal-title" id="authModalLabel">Connexion requise</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <!-- Corps de la modale -->

                <div class="modal-body">
                    <p>Vous devez être connecté pour ajouter un produit au panier. Veuillez vous connecter ou créer un compte pour continuer.</p>
                </div>

                <div class="modal-footer">
                    <a href="{% url 'connexion' %}" class="btn btn-primary">Se connecter</a>
                    <button type="button" class="btn btn-secondary close-modal-btn">Fermer</button>
                </div>

            </div>
        </div>
    </div>

{% endblock index %}

{% block jn %}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Vérifie si l'utilisateur est authentifié
        if (!userIsAuthenticated) {
            // Sélectionner tous les boutons "Ajouter"
            const addToCartButtons = document.querySelectorAll(".add-to-cart");

            // Ajouter un écouteur d'événement à chaque bouton
            addToCartButtons.forEach(button => {
                button.addEventListener("click", function (event) {
                    event.preventDefault(); // Empêche l'action par défaut
                    event.stopPropagation(); // Empêche la propagation de l'événement

                    // Afficher la modale Bootstrap
                    const authModal = new bootstrap.Modal(document.getElementById('authModal'));
                    authModal.show();
                });
            });
        }
    });

    document.addEventListener("DOMContentLoaded", function () {
        const closeModalButtons = document.querySelectorAll(".close-modal-btn");

        closeModalButtons.forEach(button => {
            button.addEventListener("click", function () {
                const authModal = bootstrap.Modal.getOrCreateInstance(document.getElementById('authModal'));
                authModal.hide(); // Ferme la modale
            });
        });
    });

</script>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
		<script src="https://unpkg.com/unlazy@0.11.3/dist/unlazy.with-hashing.iife.js" defer init></script>
		<script type="text/javascript">
			window.tailwind.config = {
				darkMode: ['class'],
				theme: {
					extend: {
						colors: {
							border: 'hsl(var(--border))',
							input: 'hsl(var(--input))',
							ring: 'hsl(var(--ring))',
							background: 'hsl(var(--background))',
							foreground: 'hsl(var(--foreground))',
							primary: {
								DEFAULT: 'hsl(var(--primary))',
								foreground: 'hsl(var(--primary-foreground))'
							},
							secondary: {
								DEFAULT: 'hsl(var(--secondary))',
								foreground: 'hsl(var(--secondary-foreground))'
							},
							destructive: {
								DEFAULT: 'hsl(var(--destructive))',
								foreground: 'hsl(var(--destructive-foreground))'
							},
							muted: {
								DEFAULT: 'hsl(var(--muted))',
								foreground: 'hsl(var(--muted-foreground))'
							},
							accent: {
								DEFAULT: 'hsl(var(--accent))',
								foreground: 'hsl(var(--accent-foreground))'
							},
							popover: {
								DEFAULT: 'hsl(var(--popover))',
								foreground: 'hsl(var(--popover-foreground))'
							},
							card: {
								DEFAULT: 'hsl(var(--card))',
								foreground: 'hsl(var(--card-foreground))'
							},
						},
					}
				}
			}
		</script>
{% endblock %}